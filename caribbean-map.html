<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Map of the Caribbean and Latin America</title>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <style type="text/css">
            /* No style rules here yet */       
        </style>
    </head>
    <body>
        <script type="text/javascript">

            //Width and height
            var w = 800;
            var h = 800;
  

            //Create SVG element
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);

            //Load in GeoJSON data
            d3.json("region_wb_Caribbean_subunits_min.json", function(json) {

                  var center = d3.geo.centroid(json)
                  var scale  = 150;
                  var offset = [w/2, h/2];
                  var projection = d3.geo.mercator().scale(scale).center(center)
                      .translate(offset);

                  // create the path
                  var path = d3.geo.path().projection(projection);

                  // using the path determine the bounds of the current map and use 
                  // these to determine better values for the scale and translation
                  var bounds  = path.bounds(json);
                  var hscale  = scale*w  / (bounds[1][0] - bounds[0][0]);
                  var vscale  = scale*h / (bounds[1][1] - bounds[0][1]);
                  var scale   = (hscale < vscale) ? hscale : vscale;
                  var offset  = [w - (bounds[0][0] + bounds[1][0])/2,
                                    h - (bounds[0][1] + bounds[1][1])/2];

                  // new projection
                  projection = d3.geo.mercator().center(center)
                    .scale(scale).translate(offset);
                  path = path.projection(projection);
            
                //Bind data and create one path per GeoJSON feature
                svg.selectAll("path")
                   .data(json.features)
                   .enter()
                   .append("path")
                   .attr("d", path)
                   .style("fill", "steelblue");

            });

        </script>
    </body>
</html>